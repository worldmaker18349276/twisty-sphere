<!DOCTYPE html>
<html lang="en">
<head>
<title> test </title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
<style>
body {
  font-family: Monospace;
  background-color: #000;
  margin: 0px;
  overflow: hidden;
}
</style>
</head>
<body>
<script src="https://rawgit.com/mrdoob/three.js/master/build/three.js"></script>
<script src="https://rawgit.com/mrdoob/three.js/master/examples/js/controls/OrbitControls.js"></script>
<script src="https://rawgit.com/mrdoob/three.js/master/examples/js/QuickHull.js"></script>
<script src="https://rawgit.com/mrdoob/three.js/master/examples/js/geometries/ConvexGeometry.js"></script>
<script src="https://rawgit.com/mrdoob/three.js/master/examples/js/libs/stats.min.js"></script>
<script src="Geometer.js"></script>

<script>

var group, camera, scene, renderer, stats, geometry;

init();
animate();

function init() {

  scene = new THREE.Scene();

  renderer = new THREE.WebGLRenderer( { antialias: true } );
  renderer.setPixelRatio( window.devicePixelRatio );
  renderer.setSize( window.innerWidth, window.innerHeight );
  document.body.appendChild( renderer.domElement );

  // camera

  camera = new THREE.PerspectiveCamera( 40, window.innerWidth / window.innerHeight, 1, 1000 );
  camera.position.set( 1.5, 2, 3 );
  scene.add( camera );

  // controls

  var controls = new THREE.OrbitControls( camera, renderer.domElement );
  controls.minDistance = 2;
  controls.maxDistance = 5;

  scene.add( new THREE.AmbientLight( 0x222222 ) );

  // light

  var light = new THREE.PointLight( 0xffffff, 1 );
  camera.add( light );

  // helper

  scene.add( new THREE.AxesHelper( 2 ) );

  // geometry

  group = new THREE.Group();
  scene.add( group );

  geometry = new THREE.Geometry();
  geometry.vertices = [
    new THREE.Vector3( 1, 0, 0), // 0
    new THREE.Vector3( 0, 1, 0), // 1
    new THREE.Vector3( 0, 0, 1), // 2
    new THREE.Vector3(-1, 0, 0), // 3
    new THREE.Vector3( 0,-1, 0), // 4
    new THREE.Vector3( 0, 0,-1)  // 5
  ];
  geometry.faces = [
    // new THREE.Face3(0, 1, 2),
    new THREE.Face3(0, 2, 4),
    new THREE.Face3(0, 4, 5),
    new THREE.Face3(0, 5, 1),
    new THREE.Face3(3, 2, 1),
    new THREE.Face3(3, 4, 2),
    new THREE.Face3(3, 5, 4),
    new THREE.Face3(3, 1, 5)
  ];
  geometry.computeFlatVertexNormals();
  Geometer.fly(geometry);
  var geometry_ = Geometer.copy(geometry);
  geometry_.translate(-1/3,-1/3,-1/3);
  geometry_.applyMatrix(new THREE.Matrix4().makeRotationAxis(new THREE.Vector3(-1,2,-1).normalize(), Math.PI));
  geometry_.translate(1/3,1/3,1/3);
  Geometer.merge(geometry, geometry_);
  Geometer.reduceVertices(geometry);
  Geometer.split(geometry, new THREE.Plane(new THREE.Vector3(-1,1,-1).normalize(), 1/Math.sqrt(3)));
  // Geometer.land(geometry);

  console.log(geometry.vertices);
  console.log(geometry.faces);
  console.log(geometry.boundaries);

  var material = new THREE.MeshLambertMaterial( { color: 0xffffff, transparent: true, opacity: 0.5 } );

  var mesh = new THREE.Mesh( geometry, material );
  group.add( mesh );

  // stats

  stats = new Stats();
  document.body.appendChild( stats.dom );

  //

  window.addEventListener( 'resize', onWindowResize, false );

}

function onWindowResize() {

  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();

  renderer.setSize( window.innerWidth, window.innerHeight );

}

function animate() {

  requestAnimationFrame( animate );

  // group.rotation.y += 0.005;

  render();
  stats.update();

}

function render() {

  renderer.render( scene, camera );

}

</script>

</body>
</html>
